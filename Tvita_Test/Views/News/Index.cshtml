
@{
    ViewBag.Title = @Utilities.Translate("News");
    ViewBag.HotNew = true;
}

<link href="@Url.Content("~/Content/css/news.css")" rel="stylesheet">

<div class="container-fluid">
    <div class="row slide-show-container">
        <div class="ss-container" id="news-slideshow">
            @foreach (var item in Model)
            {
                <div class="ss-item ss-image">
                    <img class="ss-item-cover" src="@Url.Content("~/Content/images/photos/transparent-1280x594.png")" style="background-image: url(@Url.Content("\"../../Content/pictures/" + @item.Post_Pic_URL + '"'))">
                    <div class="ss-caption-container">
                        <div class="container">
                            <div class="ss-content">
                                <div class="ss-title">
                                    @if (Utilities.languageIsActive().ToUpper() == "VI")
                                    {
                                        <label>@Html.Raw(item.Post_Name)</label>
                                        <p>@Html.Raw(item.Post_Description)</p>
                                        <div class="view-more">
                                            <a class="btn-view-more" href="@Url.Action("Details","News",new { id = item.Post_ID })">@(Utilities.Translate("ViewMore"))</a>
                                        </div>
                                    }
                                    else
                                    {
                                        <label>@Html.Raw(item.Post_Name_EN)</label>
                                        <p>@Html.Raw(item.Post_Description_EN)</p>
                                        <div class="view-more">
                                            <a class="btn-view-more" href="@Url.Action("Details","News",new { id = item.Post_ID })">@(Utilities.Translate("ViewMore"))</a>
                                        </div>
                                    }
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>
<div class="container news-page">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">@(Utilities.Translate("HomePage"))</a></li>
        <li class="breadcrumb-item active">@(Utilities.Translate("News"))</li>
    </ol>
    @*<div class="row">
        @foreach (var item in Model)
        {
            <div class="col-sm-4 col-md-4 col-lg-4">
                <div class="n-item">
                    <div class="n-cover">
                        <img src="@Url.Content("~/Content/images/photos/transparent-388x388.png")" style="background-image: url(@Url.Content("\"../../Content/pictures/" + @item.Post_Pic_URL + '"'))">
                    </div>
                    <div class="n-content">
                        @Html.Raw(item.Post_Name)
                    </div>
                    <div class="n-view-more">
                        <a href="@Url.Action("Details","News",new { id = item.Post_ID })">@(Utilities.Translate("ViewMore"))</a>
                    </div>
                </div>
            </div>
        }


    </div>*@
    <div class="list">

    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 load-more-container">
            <button class="btn btn-default js-load-more">
                <span>@(Utilities.Translate("LoadMoreNews"))</span>
            </button>
        </div>
    </div>
</div>
@section Scripts
{
    <script>
        $('#news-slideshow').slideShow({
            auto: false,
            interval: 10000,
            parent: '.slide-show-container',
            containerDimension: { width: 1920, height: 594 }
        })


        var paramPage = {
            total: 0,
            recordsInPage: 3,
            recordsDisplayed: 0
        }

        function getItems(callback) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                url: Config.AppUrl + "/News/GetItems/",
                contentType: 'application/json',
                data: paramPage,
                success: function (data) {
                    var listContainer = $('.list')
                    var indexCol = 0;
                    var row;
                    paramPage.total = data.pageInfo.total;
                    paramPage.recordsDisplayed = data.pageInfo.recordsDisplayed;

                    if (data.pageInfo.recordsDisplayed == data.pageInfo.total) {
                        $('.js-load-more').prop('disabled', true);
                        self.displayedAllItem = true;
                    }

                    $.each(data.data, function (k, v) {
                        if (indexCol % 3 == 0) {
                            row = $('<div></div>').addClass('row');
                            listContainer.append(row)
                        }
                        var item_container = $('<div class="col-sm-4 col-md-4 col-lg-4"></div>');
                        if ($('.lan.active').text() == "VI")
                        {
                            var link = $('<div class="n-item">' +
                                        '<div class="n-cover">' +
                                            '<img src="' + Config.AppUrl + '/Content/images/photos/transparent-388x388.png" style="background-image: Url(\'' + Config.AppUrl + '/Content/pictures/' + v.Post_Pic_URL + '\')">' +
                                        '</div>' +
                                        '<div class="n-content">' +
                                            v.Post_Name +
                                        '</div>' +
                                        '<div class="n-view-more">' +
                                            '<a href="' + Config.AppUrl + '/News/Details/' + v.Post_ID + '">' + $.i18n("view_more") + '</a>' +
                                        '</div>' +
                                    '</div>');
                            item_container.append(link);
                        }
                        else
                        {
                            var link = $('<div class="n-item">' +
                                        '<div class="n-cover">' +
                                            '<img src="' + Config.AppUrl + '/Content/images/photos/transparent-388x388.png" style="background-image: Url(\'' + Config.AppUrl + '/Content/pictures/' + v.Post_Pic_URL + '\')">' +
                                        '</div>' +
                                        '<div class="n-content">' +
                                            v.Post_Name_EN +
                                        '</div>' +
                                        '<div class="n-view-more">' +
                                            '<a href="' + Config.AppUrl + '/News/Details/' + v.Post_ID + '">' + $.i18n("view_more") + '</a>' +
                                        '</div>' +
                                    '</div>');
                            item_container.append(link);
                        }
                        row.append(item_container);
                        indexCol++;
                    })
                    if (callback) callback();
                },
                error: function (jqXHR, textStatus, errorThrown) {

                }
            });
        }

        $('.js-load-more').unbind().bind('click', function () {
            getItems(function () {
                checkChatInView();
            });
        })

        getItems();
    </script>
}